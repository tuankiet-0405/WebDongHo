<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        <%= typeof title !=='undefined' ? title : 'Admin | CHRONOS' %>
    </title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        primary: {
                            50: '#eff6ff', 100: '#dbeafe', 200: '#bfdbfe', 300: '#93c5fd',
                            400: '#60a5fa', 500: '#3b82f6', 600: '#2563eb', 700: '#1d4ed8',
                            800: '#1e40af', 900: '#0b2a6f',
                        },
                        slate: { 850: '#151f32' }
                    },
                    animation: {
                        'fade-in-up': 'fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: 0, transform: 'translateY(10px)' },
                            '100%': { opacity: 1, transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <style type="text/tailwindcss">
        @layer utilities {
            .glass { @apply bg-white/80 backdrop-blur-md border border-white/20 shadow-sm; }
            .card-hover { @apply transition-all duration-300 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-blue-900/5; }
            .sidebar-link { @apply flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium text-slate-500 hover:text-primary-600 hover:bg-blue-50 transition-colors; }
            .sidebar-link.active { @apply text-primary-600 bg-blue-50 border-r-2 border-primary-600 rounded-r-none; }
            .no-scrollbar::-webkit-scrollbar { display: none; }
            .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
            .btn-primary { @apply bg-primary-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary-700 transition-colors inline-flex items-center justify-center; }
            .btn-secondary { @apply bg-white border border-slate-200 text-slate-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-slate-50 transition-colors inline-flex items-center justify-center; }
            .btn-danger { @apply bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors inline-flex items-center justify-center; }
            .input-field { @apply w-full px-3 py-2 border border-slate-200 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 transition-all; }
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-900 antialiased overflow-x-hidden relative">

    <!-- Background Pattern -->
    <div class="fixed inset-0 pointer-events-none z-0 overflow-hidden opacity-[0.02]">
        <svg class="absolute -right-20 -top-20 w-[600px] h-[600px] text-primary-900 animate-spin"
            style="animation-duration: 60s;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="0.5">
            <path
                d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" />
            <path d="M12 6V12L16 14" />
        </svg>
    </div>

    <div class="flex h-screen w-full overflow-hidden relative z-10">

        <!-- Mobile Overlay -->
        <div id="sidebar-overlay" onclick="toggleSidebar()"
            class="fixed inset-0 bg-slate-900/20 backdrop-blur-sm z-40 hidden lg:hidden opacity-0 transition-opacity duration-300">
        </div>

        <!-- Sidebar -->
        <aside id="sidebar"
            class="fixed lg:static inset-y-0 left-0 z-50 w-64 bg-white border-r border-slate-200 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out flex flex-col h-full shadow-xl lg:shadow-none">
            <!-- Brand -->
            <div class="h-16 flex items-center px-6 border-b border-slate-100">
                <a href="/admin" class="flex items-center gap-2 text-primary-600">
                    <iconify-icon icon="lucide:watch" width="24" stroke-width="1.5"></iconify-icon>
                    <span class="text-lg font-bold tracking-tight text-primary-900">CHRONOS<span
                            class="text-primary-600">ADMIN</span></span>
                </a>
            </div>

            <!-- Nav -->
            <div class="flex-1 overflow-y-auto py-6 px-4 space-y-1 no-scrollbar">
                <p class="px-3 text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Quản lý chung</p>
                <a href="/admin"
                    class="sidebar-link <%= typeof currentPage !== 'undefined' && currentPage === 'dashboard' ? 'active' : '' %>">
                    <iconify-icon icon="lucide:layout-dashboard" width="18"></iconify-icon>
                    Tổng quan
                </a>
                <a href="/admin/products"
                    class="sidebar-link <%= typeof currentPage !== 'undefined' && currentPage === 'products' ? 'active' : '' %>">
                    <iconify-icon icon="lucide:package" width="18"></iconify-icon>
                    Sản phẩm
                </a>
                <a href="/admin/orders"
                    class="sidebar-link <%= typeof currentPage !== 'undefined' && currentPage === 'orders' ? 'active' : '' %>">
                    <iconify-icon icon="lucide:shopping-bag" width="18"></iconify-icon>
                    Đơn hàng
                </a>
                <a href="/admin/users"
                    class="sidebar-link <%= typeof currentPage !== 'undefined' && currentPage === 'users' ? 'active' : '' %>">
                    <iconify-icon icon="lucide:users" width="18"></iconify-icon>
                    Khách hàng
                </a>
                <a href="/admin/categories"
                    class="sidebar-link <%= typeof currentPage !== 'undefined' && currentPage === 'categories' ? 'active' : '' %>">
                    <iconify-icon icon="lucide:archive" width="18"></iconify-icon>
                    Danh mục
                </a>

                <p class="px-3 text-xs font-semibold text-slate-400 uppercase tracking-wider mt-6 mb-2">Marketing & Nội
                    dung</p>
                <a href="/admin/coupons"
                    class="sidebar-link <%= typeof currentPage !== 'undefined' && currentPage === 'coupons' ? 'active' : '' %>">
                    <iconify-icon icon="lucide:ticket" width="18"></iconify-icon>
                    Mã giảm giá
                </a>
                <a href="/admin/reviews"
                    class="sidebar-link <%= typeof currentPage !== 'undefined' && currentPage === 'reviews' ? 'active' : '' %>">
                    <iconify-icon icon="lucide:star" width="18"></iconify-icon>
                    Đánh giá
                </a>

                <p class="px-3 text-xs font-semibold text-slate-400 uppercase tracking-wider mt-6 mb-2">Hệ thống</p>
                <a href="/admin/reports"
                    class="sidebar-link <%= typeof currentPage !== 'undefined' && currentPage === 'reports' ? 'active' : '' %>">
                    <iconify-icon icon="lucide:file-text" width="18"></iconify-icon>
                    Báo cáo doanh thu
                </a>
                <a href="/admin/settings"
                    class="sidebar-link <%= typeof currentPage !== 'undefined' && currentPage === 'settings' ? 'active' : '' %>">
                    <iconify-icon icon="lucide:settings" width="18"></iconify-icon>
                    Cài đặt
                </a>
                <a href="/" class="sidebar-link">
                    <iconify-icon icon="lucide:external-link" width="18"></iconify-icon>
                    Xem website
                </a>
            </div>

            <!-- User Mini Profile -->
            <div class="p-4 border-t border-slate-100">
                <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-slate-50 cursor-pointer transition-colors">
                    <div
                        class="w-8 h-8 rounded-full bg-gradient-to-tr from-primary-500 to-indigo-600 flex items-center justify-center text-white text-xs font-medium">
                        <%= user ? user.name.charAt(0).toUpperCase() : 'A' %>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="text-sm font-medium text-slate-900 truncate">
                            <%= user ? user.name : 'Admin' %>
                        </p>
                        <p class="text-xs text-slate-500 truncate">
                            <%= user ? user.email : 'admin@chronos.vn' %>
                        </p>
                    </div>
                    <a href="/auth/logout" class="text-slate-400 hover:text-red-500">
                        <iconify-icon icon="lucide:log-out" width="16"></iconify-icon>
                    </a>
                </div>
            </div>
        </aside>

        <!-- Main Content Wrapper -->
        <main class="flex-1 flex flex-col h-full min-w-0 overflow-hidden">

            <!-- Top Header -->
            <header
                class="h-16 glass sticky top-0 z-30 px-6 flex items-center justify-between border-b border-slate-200/60">
                <div class="flex items-center gap-4 flex-1">
                    <button onclick="toggleSidebar()" class="lg:hidden text-slate-500 hover:text-primary-600">
                        <iconify-icon icon="lucide:menu" width="24"></iconify-icon>
                    </button>

                    <div class="relative hidden sm:block w-full max-w-md group">
                        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                            <iconify-icon icon="lucide:search"
                                class="text-slate-400 group-focus-within:text-primary-500 transition-colors"
                                width="18"></iconify-icon>
                        </div>
                        <input type="text" placeholder="Tìm đơn hàng, sản phẩm, khách hàng..."
                            class="block w-full pl-10 pr-3 py-2 border border-slate-200 rounded-lg leading-5 bg-slate-50/50 text-slate-900 placeholder-slate-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 sm:text-sm transition-all shadow-sm">
                    </div>
                </div>

                <div class="flex items-center gap-3">
                    <div class="text-right hidden md:block">
                        <div class="text-[10px] uppercase font-bold text-slate-400 tracking-wider">Trạng thái</div>
                        <div class="flex items-center justify-end gap-1.5">
                            <span class="relative flex h-2 w-2">
                                <span
                                    class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                                <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
                            </span>
                            <span class="text-xs font-medium text-emerald-600">Online</span>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Page Content -->
            <div class="flex-1 overflow-y-auto p-4 md:p-6 space-y-6">

                <!-- Flash Messages -->
                <% if (typeof success_msg !=='undefined' && success_msg && success_msg.length> 0) { %>
                    <div
                        class="bg-emerald-50 border border-emerald-200 text-emerald-700 px-4 py-3 rounded-lg flex items-center gap-2">
                        <iconify-icon icon="lucide:check-circle" width="18"></iconify-icon>
                        <%= success_msg %>
                    </div>
                    <% } %>
                        <% if (typeof error_msg !=='undefined' && error_msg && error_msg.length> 0) { %>
                            <div
                                class="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2">
                                <iconify-icon icon="lucide:alert-circle" width="18"></iconify-icon>
                                <%= error_msg %>
                            </div>
                            <% } %>